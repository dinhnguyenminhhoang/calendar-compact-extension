<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>L·ªãch H·ªçc & L√†m Vi·ªác</title>
    <link rel="stylesheet" href="calendar.css" />
  </head>
  <body>
    <!-- Header 2 t·∫ßng -->
    <div class="new-header">
      <!-- H√†ng 1: Logo + Auth -->
      <div class="header-top">
        <div class="header-logo" id="headerLogo">
          <img src="./icons/logoUtc2.png" alt="UTC2" width="40" height="40" />
          <span class="logo-text">UTC2 Calendar</span>
        </div>
        <div class="header-auth">
          <span id="userInfo" class="user-info" style="display: none">
            <span id="userName" class="user-name"></span>
          </span>
          <button class="btn-auth" id="btnAuth">
            <span id="authText">ƒêƒÉng nh·∫≠p</span>
          </button>
        </div>
      </div>

      <!-- H√†ng 2: Navigation + View Selection + Actions -->
      <div class="header-bottom">
        <div class="nav-controls">
          <button class="btn-nav" id="btnPrevWeek">‚óÄ</button>
          <button class="btn-today" id="btnToday">H√¥m nay</button>
          <button class="btn-nav" id="btnNextWeek">‚ñ∂</button>
        </div>

        <div class="week-range" id="weekRange"></div>

        <div class="view-selector">
          <label for="viewMode" class="view-label">Xem:</label>
          <select id="viewMode" class="view-select">
            <option value="day">Ng√†y</option>
            <option value="week" selected>Tu·∫ßn</option>
            <option value="month">Th√°ng</option>
          </select>
        </div>

        <div class="action-buttons">
          <button class="btn-icon" id="btnReload" title="T·∫£i l·∫°i">‚ü≥</button>
          <button class="btn-icon" id="btnGoogleSync" title="ƒê·ªìng b·ªô Google">
            üîó
          </button>
          <button class="btn-icon" id="btnAddEvent" title="Th√™m s·ª± ki·ªán">
            ‚ûï
          </button>
          <button class="btn-icon" id="btnSettings" title="C√†i ƒë·∫∑t">‚öôÔ∏è</button>
        </div>
      </div>
    </div>

    <div class="calendar-container">
      <div class="time-column">
        <div class="time-header"></div>
        <div class="time-slots" id="timeSlots"></div>
      </div>
      <div class="days-container" id="daysContainer"></div>
    </div>

    <div class="modal" id="eventModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Th√™m S·ª± Ki·ªán</h2>
          <button class="btn-close" id="btnCloseModal">‚úï</button>
        </div>
        <form id="eventForm">
          <!-- Template nhanh -->
          <div class="form-group">
            <label>‚ö° Template nhanh</label>
            <select id="eventTemplate" class="template-select">
              <option value="">-- Ch·ªçn template --</option>
              <option value="morning">üåÖ H·ªçc bu·ªïi s√°ng (7:00-11:30)</option>
              <option value="afternoon">üå§Ô∏è H·ªçc bu·ªïi chi·ªÅu (13:00-17:00)</option>
              <option value="work">üíº L√†m vi·ªác (8:00-17:00)</option>
              <option value="meeting">üë• H·ªçp (1 ti·∫øng)</option>
              <option value="custom">‚úèÔ∏è T√πy ch·ªânh</option>
            </select>
            <small
              style="
                color: #6b7280;
                font-size: 11px;
                display: block;
                margin-top: 4px;
              "
            >
              Ch·ªçn template ƒë·ªÉ ƒëi·ªÅn nhanh th√¥ng tin
            </small>
          </div>

          <div class="form-group">
            <label>Lo·∫°i s·ª± ki·ªán</label>
            <select id="eventType" required>
              <option value="study">üìö L·ªãch H·ªçc</option>
              <option value="work">üíº L·ªãch L√†m Vi·ªác</option>
              <option value="meeting">üë• H·ªçp/Meeting</option>
              <option value="personal">üéØ C√° nh√¢n</option>
            </select>
          </div>

          <div class="form-group">
            <label>Ti√™u ƒë·ªÅ</label>
            <input
              type="text"
              id="eventTitle"
              placeholder="VD: H·ªçc To√°n"
              required
            />
          </div>

          <!-- ƒê·ªãa ƒëi·ªÉm -->
          <div class="form-group">
            <label>üìç ƒê·ªãa ƒëi·ªÉm</label>
            <input
              type="text"
              id="eventLocation"
              placeholder="VD: Ph√≤ng A101, Zoom, Online..."
            />
          </div>

          <!-- ∆Øu ti√™n -->
          <div class="form-group">
            <label>‚≠ê M·ª©c ƒë·ªô ∆∞u ti√™n</label>
            <div class="priority-selector">
              <label class="priority-option">
                <input type="radio" name="eventPriority" value="high" />
                <span class="priority-badge priority-high">‚óè Cao</span>
              </label>
              <label class="priority-option">
                <input
                  type="radio"
                  name="eventPriority"
                  value="medium"
                  checked
                />
                <span class="priority-badge priority-medium">‚óè Trung b√¨nh</span>
              </label>
              <label class="priority-option">
                <input type="radio" name="eventPriority" value="low" />
                <span class="priority-badge priority-low">‚óã Th·∫•p</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>M√¥ t·∫£</label>
            <textarea
              id="eventDescription"
              placeholder="M√¥ t·∫£ chi ti·∫øt..."
              rows="3"
            ></textarea>
          </div>

          <!-- Tags nhanh -->
          <div class="form-group">
            <label>üè∑Ô∏è Tags nhanh</label>
            <div class="tags-selector">
              <label class="tag-option">
                <input type="checkbox" name="eventTags" value="deadline" />
                <span class="tag-badge">#deadline</span>
              </label>
              <label class="tag-option">
                <input type="checkbox" name="eventTags" value="important" />
                <span class="tag-badge">#important</span>
              </label>
              <label class="tag-option">
                <input type="checkbox" name="eventTags" value="quiz" />
                <span class="tag-badge">#quiz</span>
              </label>
              <label class="tag-option">
                <input type="checkbox" name="eventTags" value="assignment" />
                <span class="tag-badge">#assignment</span>
              </label>
              <label class="tag-option">
                <input type="checkbox" name="eventTags" value="exam" />
                <span class="tag-badge">#exam</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
              "
            >
              <span>üîó Links</span>
              <button
                type="button"
                class="btn-add-link"
                id="btnAddLink"
                style="
                  padding: 4px 12px;
                  font-size: 12px;
                  background: #667eea;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                "
              >
                ‚ûï Th√™m link
              </button>
            </label>
            <div
              id="linksContainer"
              style="display: flex; flex-direction: column; gap: 8px"
            >
              <div
                class="link-input-group"
                style="display: flex; gap: 8px; align-items: center"
              >
                <input
                  type="url"
                  class="event-link"
                  placeholder="https://meet.google.com/..."
                  style="flex: 1"
                />
                <button
                  type="button"
                  class="btn-remove-link"
                  style="
                    display: none;
                    width: 32px;
                    height: 32px;
                    background: #ef4444;
                    color: white;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    font-size: 16px;
                  "
                >
                  ‚úï
                </button>
              </div>
            </div>
            <small
              style="
                color: #6b7280;
                font-size: 11px;
                margin-top: 4px;
                display: block;
              "
              >Th√™m link Zoom, Meet, t√†i li·ªáu, ho·∫∑c website li√™n quan</small
            >
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Ng√†y b·∫Øt ƒë·∫ßu</label>
              <input type="date" id="eventDate" required />
            </div>
            <div class="form-group">
              <label>L·∫∑p l·∫°i ƒë·∫øn ng√†y (t√πy ch·ªçn)</label>
              <input type="date" id="eventEndDate" />
              <small style="color: #6b7280; font-size: 11px"
                >L·∫∑p l·∫°i h√†ng tu·∫ßn cho ƒë·∫øn ng√†y n√†y</small
              >
            </div>
          </div>

          <div class="form-group">
            <label>L·∫∑p l·∫°i v√†o c√°c th·ª© (t√πy ch·ªçn)</label>
            <div class="weekday-selector">
              <label class="weekday-option">
                <input type="checkbox" name="weekdays" value="1" />
                <span>T2</span>
              </label>
              <label class="weekday-option">
                <input type="checkbox" name="weekdays" value="2" />
                <span>T3</span>
              </label>
              <label class="weekday-option">
                <input type="checkbox" name="weekdays" value="3" />
                <span>T4</span>
              </label>
              <label class="weekday-option">
                <input type="checkbox" name="weekdays" value="4" />
                <span>T5</span>
              </label>
              <label class="weekday-option">
                <input type="checkbox" name="weekdays" value="5" />
                <span>T6</span>
              </label>
              <label class="weekday-option">
                <input type="checkbox" name="weekdays" value="6" />
                <span>T7</span>
              </label>
              <label class="weekday-option">
                <input type="checkbox" name="weekdays" value="0" />
                <span>CN</span>
              </label>
            </div>
            <small style="color: #6b7280; font-size: 11px"
              >Ch·ªçn c√°c th·ª© mu·ªën l·∫∑p l·∫°i. ƒê·ªÉ tr·ªëng = ch·ªâ l·∫∑p th·ª© c·ªßa ng√†y b·∫Øt
              ƒë·∫ßu</small
            >
          </div>

          <!-- Ch·∫ø ƒë·ªô ch·ªçn th·ªùi gian -->
          <div class="form-group">
            <label>‚è∞ Ch·∫ø ƒë·ªô ch·ªçn th·ªùi gian</label>
            <div class="time-mode-selector">
              <label class="time-mode-option">
                <input type="radio" name="timeMode" value="time" checked />
                <span class="mode-badge">üïê Theo gi·ªù</span>
              </label>
              <label class="time-mode-option">
                <input type="radio" name="timeMode" value="period" />
                <span class="mode-badge">üìö Theo ti·∫øt h·ªçc</span>
              </label>
            </div>
          </div>

          <!-- Ch·ªçn theo gi·ªù -->
          <div id="timeModeContainer" class="form-row">
            <div class="form-group">
              <label>Gi·ªù b·∫Øt ƒë·∫ßu</label>
              <input type="time" id="eventStartTime" required />
            </div>
            <div class="form-group">
              <label>Gi·ªù k·∫øt th√∫c</label>
              <input type="time" id="eventEndTime" required />
            </div>
          </div>

          <!-- Ch·ªçn theo ti·∫øt h·ªçc -->
          <div id="periodModeContainer" class="form-row" style="display: none">
            <div class="form-group">
              <label>Ti·∫øt b·∫Øt ƒë·∫ßu</label>
              <select id="eventStartPeriod">
                <option value="1">Ti·∫øt 1 (7:00-7:50)</option>
                <option value="2">Ti·∫øt 2 (8:00-8:50)</option>
                <option value="3">Ti·∫øt 3 (9:00-9:50)</option>
                <option value="4">Ti·∫øt 4 (10:00-10:50)</option>
                <option value="5">Ti·∫øt 5 (11:00-11:50)</option>
                <option value="6">Ti·∫øt 6 (13:00-13:50)</option>
                <option value="7">Ti·∫øt 7 (14:00-14:50)</option>
                <option value="8">Ti·∫øt 8 (15:00-15:50)</option>
                <option value="9">Ti·∫øt 9 (16:00-16:50)</option>
                <option value="10">Ti·∫øt 10 (17:00-17:50)</option>
              </select>
            </div>
            <div class="form-group">
              <label>Ti·∫øt k·∫øt th√∫c</label>
              <select id="eventEndPeriod">
                <option value="1">Ti·∫øt 1 (7:00-7:50)</option>
                <option value="2">Ti·∫øt 2 (8:00-8:50)</option>
                <option value="3">Ti·∫øt 3 (9:00-9:50)</option>
                <option value="4">Ti·∫øt 4 (10:00-10:50)</option>
                <option value="5">Ti·∫øt 5 (11:00-11:50)</option>
                <option value="6">Ti·∫øt 6 (13:00-13:50)</option>
                <option value="7">Ti·∫øt 7 (14:00-14:50)</option>
                <option value="8">Ti·∫øt 8 (15:00-15:50)</option>
                <option value="9">Ti·∫øt 9 (16:00-16:50)</option>
                <option value="10">Ti·∫øt 10 (17:00-17:50)</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>M√†u s·∫Øc</label>
            <div class="color-picker">
              <label class="color-option">
                <input type="radio" name="eventColor" value="#8b5cf6" checked />
                <span class="color-box" style="background: #8b5cf6"></span>
              </label>
              <label class="color-option">
                <input type="radio" name="eventColor" value="#ec4899" />
                <span class="color-box" style="background: #ec4899"></span>
              </label>
              <label class="color-option">
                <input type="radio" name="eventColor" value="#06b6d4" />
                <span class="color-box" style="background: #06b6d4"></span>
              </label>
              <label class="color-option">
                <input type="radio" name="eventColor" value="#10b981" />
                <span class="color-box" style="background: #10b981"></span>
              </label>
              <label class="color-option">
                <input type="radio" name="eventColor" value="#f59e0b" />
                <span class="color-box" style="background: #f59e0b"></span>
              </label>
              <label class="color-option">
                <input type="radio" name="eventColor" value="#ef4444" />
                <span class="color-box" style="background: #ef4444"></span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>Nh·∫Øc nh·ªü</label>
            <select id="eventReminder">
              <option value="none">Kh√¥ng nh·∫Øc nh·ªü</option>
              <option value="5">5 ph√∫t tr∆∞·ªõc</option>
              <option value="15" selected>15 ph√∫t tr∆∞·ªõc</option>
              <option value="30">30 ph√∫t tr∆∞·ªõc</option>
              <option value="60">1 gi·ªù tr∆∞·ªõc</option>
              <option value="1440">1 ng√†y tr∆∞·ªõc</option>
            </select>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" id="btnCancelModal">
              H·ªßy
            </button>
            <button type="submit" class="btn btn-primary">L∆∞u</button>
          </div>
        </form>
      </div>
    </div>

    <div class="modal" id="settingsModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>‚öôÔ∏è C√†i ƒê·∫∑t (Nh·ªõ ƒë√°nh gi√° 5* nh√©)</h2>
          <button class="btn-close" id="btnCloseSettings">‚úï</button>
        </div>
        <div class="settings-content">
          <div class="settings-section">
            <h3>üé® Giao di·ªán</h3>
            <div class="setting-item">
              <label>Gi·ªù b·∫Øt ƒë·∫ßu hi·ªÉn th·ªã</label>
              <select id="settingStartHour">
                <option value="0">00:00</option>
                <option value="6">06:00</option>
                <option value="7" selected>07:00</option>
                <option value="8">08:00</option>
              </select>
            </div>
            <div class="setting-item">
              <label>Gi·ªù k·∫øt th√∫c hi·ªÉn th·ªã</label>
              <select id="settingEndHour">
                <option value="18">18:00</option>
                <option value="20">20:00</option>
                <option value="22" selected>22:00</option>
                <option value="24">24:00</option>
              </select>
            </div>
          </div>

          <div class="settings-section">
            <h3>üîî Nh·∫Øc nh·ªü</h3>

            <!-- B·∫≠t th√¥ng b√°o trong Chrome -->
            <div class="setting-item">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  id="settingEnableNotifications"
                  checked
                />
                <span>B·∫≠t th√¥ng b√°o trong tr√¨nh duy·ªát</span>
              </label>
            </div>

            <div class="setting-item">
              <label>Email nh·∫≠n th√¥ng b√°o</label>
              <input
                type="email"
                id="settingEmailAddress"
                placeholder="VD: mssv@st.utc2.edu.vn"
                style="
                  width: 100%;
                  padding: 8px 12px;
                  border: 1px solid #d1d5db;
                  border-radius: 6px;
                  font-size: 13px;
                "
              />
              <label class="checkbox-label" style="margin-top: 6px">
                <input type="checkbox" id="settingEnableEmail" />
                <span>G·ª≠i th√™m email nh·∫Øc l·ªãch</span>
              </label>
              <small style="color: #6b7280; display: block; margin-top: 4px">
                Khi ƒë·∫øn gi·ªù nh·∫Øc, h·ªá th·ªëng s·∫Ω g·ª≠i th√¥ng b√°o tr√™n tr√¨nh duy·ªát v√†
                (n·∫øu ƒë√£ c·∫•u h√¨nh server) g·ª≠i th√™m email t·ªõi ƒë·ªãa ch·ªâ n√†y.
              </small>
            </div>
          </div>

          <div class="settings-section">
            <h3>üîó T√≠ch h·ª£p Google</h3>
            <div class="setting-item">
              <div
                class="google-status-box"
                style="
                  padding: 12px;
                  background: #f3f4f6;
                  border-radius: 8px;
                  margin-bottom: 12px;
                "
              >
                <small
                  id="googleStatus"
                  style="color: #6b7280; font-weight: 500"
                  >Ch∆∞a k·∫øt n·ªëi</small
                >
              </div>
              <button
                class="btn btn-primary"
                id="btnConnectGoogle"
                style="margin-bottom: 8px"
              >
                K·∫øt n·ªëi v·ªõi Google
              </button>
              <button
                class="btn btn-secondary"
                id="btnDisconnectGoogle"
                style="display: none; margin-bottom: 12px"
              >
                Ng·∫Øt k·∫øt n·ªëi
              </button>
              <small style="color: #6b7280; display: block; margin-bottom: 16px"
                >K·∫øt n·ªëi ƒë·ªÉ t·ª± ƒë·ªông t·∫£i b√†i t·∫≠p t·ª´ Classroom</small
              >
            </div>
            <div class="setting-item">
              <label class="checkbox-label" style="opacity: 0.5">
                <input type="checkbox" id="settingSyncClassroom" disabled />
                <span>T·ª± ƒë·ªông t·∫£i b√†i t·∫≠p t·ª´ Google Classroom</span>
              </label>
              <small
                style="
                  color: #6b7280;
                  display: block;
                  margin-left: 26px;
                  margin-top: 4px;
                "
                >T·∫£i deadline v√† th√¥ng tin b√†i t·∫≠p t·ª± ƒë·ªông</small
              >
            </div>
          </div>

          <div class="settings-section">
            <h3>üìä D·ªØ li·ªáu</h3>
            <div class="setting-item">
              <button class="btn btn-secondary" id="btnExportData">
                Xu·∫•t d·ªØ li·ªáu
              </button>
              <button class="btn btn-secondary" id="btnImportData">
                Nh·∫≠p d·ªØ li·ªáu
              </button>
              <input
                type="file"
                id="importFile"
                accept=".json"
                style="display: none"
              />
            </div>
            <div class="setting-item">
              <button class="btn btn-secondary" id="btnClearGoogleCache">
                üîÑ X√≥a cache Google v√† sync l·∫°i
              </button>
              <small style="color: #6b7280; display: block; margin-top: 4px"
                >X√≥a t·∫•t c·∫£ events t·ª´ Google v√† t·∫£i l·∫°i t·ª´ ƒë·∫ßu</small
              >
            </div>
            <div class="setting-item">
              <button class="btn btn-danger" id="btnClearData">
                üóëÔ∏è X√≥a t·∫•t c·∫£ d·ªØ li·ªáu
              </button>
            </div>
          </div>

          <div class="settings-section">
            <h3>üìà Th·ªëng k√™</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value" id="statStudyCount">0</div>
                <div class="stat-label">L·ªãch h·ªçc</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="statWorkCount">0</div>
                <div class="stat-label">L·ªãch l√†m vi·ªác</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="statTotalCount">0</div>
                <div class="stat-label">T·ªïng c·ªông</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="event-popup" id="eventPopup" style="display: none">
      <div class="event-popup-content">
        <div class="popup-header">
          <h3 id="popupTitle"></h3>
          <button class="btn-close-small" id="btnClosePopup">‚úï</button>
        </div>
        <div class="popup-body">
          <div class="popup-time" id="popupTime"></div>
          <div class="popup-description" id="popupDescription"></div>
        </div>
        <div class="popup-actions">
          <button class="btn-small btn-edit" id="btnEditPopup">‚úèÔ∏è S·ª≠a</button>
          <button class="btn-small btn-delete" id="btnDeletePopup">
            üóëÔ∏è X√≥a
          </button>
        </div>
      </div>
    </div>

    <div class="modal" id="loginModal">
      <div class="modal-content login-card">
        <div class="login-hero">
          <img
            src="./icons/logoUtc2.png"
            alt="ƒêƒÉng nh·∫≠p Sinh vi√™n"
            class="login-hero-image"
            width="80"
            height="80"
          />
          <div class="login-title">ƒêƒÉng nh·∫≠p Sinh vi√™n</div>
          <div class="login-subtitle">
            Nh·∫≠p m√£ sinh vi√™n ƒë·ªÉ ƒë·ªìng b·ªô l·ªãch tr∆∞·ªùng
          </div>
        </div>
        <form id="loginForm" class="login-form">
          <label for="studentId">M√£ sinh vi√™n</label>
          <input
            type="text"
            id="studentId"
            placeholder="VD: 6xxxxxxx"
            required
          />
          <div class="form-actions">
            <button type="button" class="btn btn-secondary" id="btnCancelLogin">
              H·ªßy
            </button>
            <button type="submit" class="btn btn-primary">ƒêƒÉng nh·∫≠p</button>
          </div>
        </form>
      </div>
    </div>

    <script src="google-integration.js"></script>
    <script src="calendar.js"></script>
  </body>
</html>
